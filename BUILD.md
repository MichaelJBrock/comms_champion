# How to Build

This project uses [CMake](https://cmake.org) cross-platform build system to
generate required build files native to the platform.

## Available CMake Options

In addition to built-in options/variables of CMake, such as **CMAKE_BUILD_TYPE** or
**CMAKE_TOOLCHAIN_FILE**, the following ones can be used:

- **CC_COMMS_LIB_ONLY**=ON/OFF - Exclude compilation of all the tools, install only
**COMMS** Library. Default value is **OFF**, i.e. other tools get built.

- **CC_NO_UNIT_TESTS**=ON/OFF - Exclude build of unit tests. Default value is 
**OFF**, i.e. the unit tests get built.

- **CC_NO_WARN_AS_ERR**=ON/OFF - By default, all warnings are treated as
errors. Enable this option in case the compiler generates warning and fails the
compilation. Please open the issue when such scenario occurs. Default value is 
**OFF**.

- **CC_STATIC_RUNTIME**=ON/OFF - Enable/Disable static link to C++ runtime. Default value is **OFF**

- **CC_INSTALL_DIR**=dir - Custom installation directory. If not provided defaults to
**install** subdirectory of the directory chosen for build (**${CMAKE_BINARY_DIR}/install**).

- **CC_QT_DIR**=dir - Directory of QT5 installation. Can be used to provide path to QT5 if
differs from system default installation path.

## Build and Install Examples

The examples below are Linux/Unix system oriented, i.e. they use **make** utility
to build the "install" target after configuration with **cmake**. 

On Windows
systems with Visual Studio compiler, the CMake utility generates Visual Studio
solution files by default. Build "install" project. It is also possible to 
generate Makefile-s on Windows by providing additional **-G "NMake Makefiles"** option
to **cmake**. In this case use **nmake** utility instead of **make**.

Please review the examples below and use appropriate option that suites your
needs. Remember to add **-DCMAKE_BUILD_TYPE=Release** option for release
builds.


### Install Only **COMMS** Library Example
This example will skip build of any tool available, it will just install 
the **COMMS** library headers in **install/include** subdirectory.

```
$> cd /path/to/comms_champion
$> mkdir build && cd build
$> cmake -DCMAKE_BUILD_TYPE=Release -DCC_COMMS_LIB_ONLY=ON -DCC_NO_UNIT_TESTS=ON ..
$> make install 
```

### Custom Install Directory Example
This example will install all the produced files into the provided sustom
install directory (**/some/custom/dir**).

```
$> cd /path/to/comms_champion/sources
$> mkdir build && cd build
$> cmake -DCMAKE_BUILD_TYPE=Release -DCC_INSTALL_DIR=/some/custom/dir ..
$> make install 
```

### Windows + Visual Studio Build Example
Generate Makefile-s with **cmake** and use Visual Studio compiler to build.
```
$> cd /path/to/comms_champion
$> mkdir build && cd build
$> cmake -DCMAKE_BUILD_TYPE=Release -DCC_QT_DIR=C:\Qt\Qt5.7.1\5.7\msvc2015 -G "NMake Makefiles" ..
$> nmake install 
```

## Building Documentation
The documentation is not created during normal build process. The documentation of
the [COMMS Library](#comms-library) can be generated by building **doc_comms**
target:

``` 
$> make doc_comms
```

The HTML documentation will reside in **${CC_INSTALL_DIR}/doc/comms/html** subdirectory.

The documentation of
the [Demo](#demo-protocol) protocol can be generated by building **doc_demo**
target:
 
```
$> make doc_demo
```

The HTML documentation will reside in **${CC_INSTALL_DIR}/doc/demo/html** subdirectory.

**NOTE**, that you must have 
[Doxygen](www.doxygen.org) 
and [Dia](https://wiki.gnome.org/Apps/Dia) 
being installed on your system in order to be able to properly generate the 
documentation.

# Working Builds
The build hast been tested with the following compilers:

- GCC v5.4.0 on Ubuntu 16.04
- Visual Studio 2015 on Windows 7
